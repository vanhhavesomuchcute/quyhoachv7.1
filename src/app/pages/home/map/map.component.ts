import { Component, ViewChild } from '@angular/core';
import { MatDrawer } from '@angular/material/sidenav';

declare var abp: any;

@Component({
  selector: 'app-home-map',
  templateUrl: './map.component.html',
  styleUrls: ['./map.component.scss'],
})
export class HomeMapComponent {
  @ViewChild('drawer') sidenav: MatDrawer;

  listMap: any = { "items": [{ "id": "b66f480d-c3c6-4322-831f-d43df737d64b", "name": "Untitled Import", "description": "", "ownerId": "012673bc-2bb1-4ccf-af78-7793b19b3144", "privacy": "private", "createdAt": "2022-10-13T03:49:11.000Z", "updatedAt": "2022-10-13T03:49:11.000Z", "permission": "editor", "isEditable": true, "resourceType": "map", "tags": [] }, { "id": "1d612d94-5441-42ca-a0d0-2e81e1234407", "name": "Untitled", "description": "", "ownerId": "012673bc-2bb1-4ccf-af78-7793b19b3144", "privacy": "private", "createdAt": "2022-10-13T03:35:26.000Z", "updatedAt": "2022-10-13T03:35:26.000Z", "permission": "editor", "isEditable": true, "resourceType": "map", "tags": [] }, { "id": "7e1e3194-1134-4eb6-9cab-61264d9a4848", "name": "Untitled", "description": "", "ownerId": "012673bc-2bb1-4ccf-af78-7793b19b3144", "privacy": "private", "createdAt": "2022-10-13T03:35:25.000Z", "updatedAt": "2022-10-13T03:35:25.000Z", "permission": "editor", "isEditable": true, "resourceType": "map", "tags": [] }, { "id": "652b755d-bebf-47e1-bf0d-f4b327287491", "name": "Untitled", "description": "", "ownerId": "012673bc-2bb1-4ccf-af78-7793b19b3144", "privacy": "private", "createdAt": "2022-10-13T03:35:21.000Z", "updatedAt": "2022-10-13T03:35:21.000Z", "permission": "editor", "isEditable": true, "resourceType": "map", "tags": [] }, { "id": "288bc0d7-e4c3-4bc8-918b-a3f81bce0fac", "name": "Untitled", "description": "", "ownerId": "012673bc-2bb1-4ccf-af78-7793b19b3144", "privacy": "private", "createdAt": "2022-10-13T03:34:25.000Z", "updatedAt": "2022-10-13T03:34:25.000Z", "permission": "editor", "isEditable": true, "resourceType": "map", "tags": [] }, { "id": "53f9da29-3f71-4f1e-98a1-0b151f796425", "name": "Untitled", "description": "", "ownerId": "012673bc-2bb1-4ccf-af78-7793b19b3144", "privacy": "private", "createdAt": "2022-10-13T03:34:22.000Z", "updatedAt": "2022-10-13T03:34:22.000Z", "permission": "editor", "isEditable": true, "resourceType": "map", "tags": [] }, { "id": "251a0335-458c-47b7-bff0-e46a5883efb3", "name": "Untitled", "description": "", "ownerId": "012673bc-2bb1-4ccf-af78-7793b19b3144", "privacy": "private", "createdAt": "2022-10-13T03:34:20.000Z", "updatedAt": "2022-10-13T03:34:20.000Z", "permission": "editor", "isEditable": true, "resourceType": "map", "tags": [] }, { "id": "8ff2d5ad-0360-424c-88b4-e9c56442475f", "name": "Untitled", "description": "", "ownerId": "012673bc-2bb1-4ccf-af78-7793b19b3144", "privacy": "private", "createdAt": "2022-10-13T03:34:19.000Z", "updatedAt": "2022-10-13T03:34:19.000Z", "permission": "editor", "isEditable": true, "resourceType": "map", "tags": [] }, { "id": "d599aa7b-46cc-4864-b563-407ece5c3a68", "name": "Untitled", "description": "", "ownerId": "012673bc-2bb1-4ccf-af78-7793b19b3144", "privacy": "private", "createdAt": "2022-10-13T03:34:14.000Z", "updatedAt": "2022-10-13T03:34:14.000Z", "permission": "editor", "isEditable": true, "resourceType": "map", "tags": [] }, { "id": "2e517226-ada1-43f4-b057-b549c61874c2", "name": "Untitled", "description": "", "ownerId": "012673bc-2bb1-4ccf-af78-7793b19b3144", "privacy": "private", "createdAt": "2022-10-13T03:34:02.000Z", "updatedAt": "2022-10-13T03:34:02.000Z", "permission": "editor", "isEditable": true, "resourceType": "map", "tags": [] }, { "id": "cfbe5155-5be6-457c-9dc0-a049c7f53309", "name": "Untitled", "description": "", "ownerId": "012673bc-2bb1-4ccf-af78-7793b19b3144", "privacy": "private", "createdAt": "2022-10-13T03:33:39.000Z", "updatedAt": "2022-10-13T03:33:39.000Z", "permission": "editor", "isEditable": true, "resourceType": "map", "tags": [] }, { "id": "560b6f36-4c55-4592-bae9-0d9d9a2c0da1", "name": "Untitled", "description": "", "ownerId": "012673bc-2bb1-4ccf-af78-7793b19b3144", "privacy": "private", "createdAt": "2022-10-13T03:33:30.000Z", "updatedAt": "2022-10-13T03:33:30.000Z", "permission": "editor", "isEditable": true, "resourceType": "map", "tags": [] }, { "id": "e558f348-54a2-4a5c-afae-ab5ab5d664c4", "name": "Untitled", "description": "", "ownerId": "012673bc-2bb1-4ccf-af78-7793b19b3144", "privacy": "private", "createdAt": "2022-10-13T03:33:25.000Z", "updatedAt": "2022-10-13T03:33:25.000Z", "permission": "editor", "isEditable": true, "resourceType": "map", "tags": [] }, { "id": "40067f0a-04bb-4c95-9f5b-4b8e9febe393", "name": "Untitled", "description": "", "ownerId": "012673bc-2bb1-4ccf-af78-7793b19b3144", "privacy": "private", "createdAt": "2022-10-13T03:33:24.000Z", "updatedAt": "2022-10-13T03:33:24.000Z", "permission": "editor", "isEditable": true, "resourceType": "map", "tags": [] }, { "id": "9855c7f9-e897-4b8a-8f32-dcdd12179809", "name": "Untitled", "description": "", "ownerId": "012673bc-2bb1-4ccf-af78-7793b19b3144", "privacy": "private", "createdAt": "2022-10-13T03:33:19.000Z", "updatedAt": "2022-10-13T03:33:19.000Z", "permission": "editor", "isEditable": true, "resourceType": "map", "tags": [] }, { "id": "d0b6e12f-6f58-4a4b-a028-221ed54af322", "name": "Untitled", "description": "", "ownerId": "012673bc-2bb1-4ccf-af78-7793b19b3144", "privacy": "private", "createdAt": "2022-10-13T03:32:55.000Z", "updatedAt": "2022-10-13T03:32:55.000Z", "permission": "editor", "isEditable": true, "resourceType": "map", "tags": [] }, { "id": "2e54ba54-faed-493e-a2c0-e516b3e2f680", "name": "Untitled", "description": "", "ownerId": "012673bc-2bb1-4ccf-af78-7793b19b3144", "privacy": "private", "createdAt": "2022-10-13T03:32:54.000Z", "updatedAt": "2022-10-13T03:32:54.000Z", "permission": "editor", "isEditable": true, "resourceType": "map", "tags": [] }, { "id": "b33fb37f-55fc-41f9-9b61-cefe3f0c8001", "name": "Giao thông Việt Nam", "description": "Bản đồ giao thông Việt Nam bao gồm:\n- Hệ thống đường cao tốc\n- Hệ thống đường bộ\n- Hệ thống đường sắt\n- Các nhà ga xe lửa\n- Các sân bay\n- Các cảng biển", "ownerId": "012673bc-2bb1-4ccf-af78-7793b19b3144", "privacy": "private", "createdAt": "2022-10-11T06:39:30.000Z", "updatedAt": "2022-10-13T03:23:07.000Z", "permission": "editor", "isEditable": true, "resourceType": "map", "isPublished": true, "latestPublishedMap": { "id": "d934c297-49d3-4905-a130-99bca0b30ba7", "name": "Giao thông Việt Nam", "description": "Bản đồ giao thông Việt Nam bao gồm:\n- Hệ thống đường cao tốc\n- Hệ thống đường bộ\n- Hệ thống đường sắt\n- Các nhà ga xe lửa\n- Các sân bay\n- Các cảng biển", "hasPassword": false, "datasets": [{ "id": "5e790b6e-319c-4938-9697-56c036ab1122", "url": "https://cdn.published.unfolded.ai/maps/b33fb37f-55fc-41f9-9b61-cefe3f0c8001/published/d934c297-49d3-4905-a130-99bca0b30ba7/dataset-5e790b6e-319c-4938-9697-56c036ab1122.json", "name": "811_ga_duong_sat_120116.json", "type": "managed" }, { "id": "9b0cd2d8-2d06-4f01-b9f3-682b3638becf", "url": "https://cdn.published.unfolded.ai/maps/b33fb37f-55fc-41f9-9b61-cefe3f0c8001/published/d934c297-49d3-4905-a130-99bca0b30ba7/dataset-9b0cd2d8-2d06-4f01-b9f3-682b3638becf.json", "name": "811_cang_hang_khong_120116.json", "type": "managed" }, { "id": "b8d2ae2c-109e-45aa-a7c4-fb412f863971", "url": "https://cdn.published.unfolded.ai/maps/b33fb37f-55fc-41f9-9b61-cefe3f0c8001/published/d934c297-49d3-4905-a130-99bca0b30ba7/dataset-b8d2ae2c-109e-45aa-a7c4-fb412f863971.json", "name": "811_duong_bo_120116.json", "type": "managed" }, { "id": "be5ab8e7-bff4-4264-bf2a-a41f39c56ab3", "url": "https://cdn.published.unfolded.ai/maps/b33fb37f-55fc-41f9-9b61-cefe3f0c8001/published/d934c297-49d3-4905-a130-99bca0b30ba7/dataset-be5ab8e7-bff4-4264-bf2a-a41f39c56ab3.json", "name": "811_cang_bien_120116.json", "type": "managed" }, { "id": "c2a36909-2bf7-4f9e-b384-b6d04cc377f4", "url": "https://cdn.published.unfolded.ai/maps/b33fb37f-55fc-41f9-9b61-cefe3f0c8001/published/d934c297-49d3-4905-a130-99bca0b30ba7/dataset-c2a36909-2bf7-4f9e-b384-b6d04cc377f4.json", "name": "H010100_cao_toc_120617.json", "type": "managed" }, { "id": "fc4cb666-1cc8-42dc-9934-4106295cb6e0", "url": "https://cdn.published.unfolded.ai/maps/b33fb37f-55fc-41f9-9b61-cefe3f0c8001/published/d934c297-49d3-4905-a130-99bca0b30ba7/dataset-fc4cb666-1cc8-42dc-9934-4106295cb6e0.json", "name": "811_duong_sat_120116.json", "type": "managed" }], "studioState": { "url": "https://cdn.published.unfolded.ai/maps/b33fb37f-55fc-41f9-9b61-cefe3f0c8001/published/d934c297-49d3-4905-a130-99bca0b30ba7/studio-state.json" }, "previewPath": "https://cdn.published.unfolded.ai/maps/b33fb37f-55fc-41f9-9b61-cefe3f0c8001/published/d934c297-49d3-4905-a130-99bca0b30ba7/preview.png", "numberOfViews": 1, "sourceMapId": "b33fb37f-55fc-41f9-9b61-cefe3f0c8001", "settings": { "minimalBranding": false, "allowExportData": false, "sidePanelVisibility": "visible", "mapInfoVisibility": "visible", "mapLegendVisibility": "visible", "mapDrawVisibility": "hidden", "chartVisibility": "collapsed" }, "createdAt": "2022-10-13T03:23:53.000Z", "updatedAt": "2022-10-13T03:24:05.000Z", "owner": { "id": "012673bc-2bb1-4ccf-af78-7793b19b3144", "name": "Nguyen Anh Tuan", "pictureUrl": "https://s.gravatar.com/avatar/b76db524bd4e8b82590e914cbb417b74?s=480&r=pg&d=https%3A%2F%2Fcdn.auth0.com%2Favatars%2Ftu.png" } }, "previewReadPath": "https://unfolded-data-production.storage.googleapis.com/userdata/012673bc-2bb1-4ccf-af78-7793b19b3144/maps/b33fb37f-55fc-41f9-9b61-cefe3f0c8001/preview.jpeg?X-Goog-Algorithm=GOOG4-RSA-SHA256&X-Goog-Credential=sharp-starlight-258101%40appspot.gserviceaccount.com%2F20221013%2Fauto%2Fstorage%2Fgoog4_request&X-Goog-Date=20221013T085326Z&X-Goog-Expires=1800&X-Goog-SignedHeaders=host&x-goog-signature=3d842e334ab8918ea7e9ccf7edc8fc2d3d28a26aed38b5c702437f27ad15c82b9d0a71aa1e063b403ed6bf9710e4267bdc62dfe673d33ccd442f80a181cb54aecd688a55b1eac5b851f5abbe4b64edec3e85f562b3b3a54dc04f010d24e8aa3025d09b1ec925c042317a28bc54964f693c74fccf9977bf5df5daf341602587df927c8f586419904e6809b65b3992a1f96faaa2f142be7f88a3c4e21defbe9c468ee9bd7cc2fc56e63f56afbcaaf58bba338fcb9887c7e5fe4cf0c3c107216370336662a7394ddd961592d4793098d54e796f16edf4865d93dbfe341419e57f919f3eb16c9ecb253cccd289d1741a5045212085be14d8af4ac5f8772836d93f64", "tags": [] }, { "id": "663e603f-e76a-4d1d-a3b5-f8dfc82d5cbc", "name": "Thủy điện Việt Nam", "description": "Bản đồ phân bố các nhà máy thủy điện trên toàn lãnh thổ Việt Nam", "ownerId": "012673bc-2bb1-4ccf-af78-7793b19b3144", "privacy": "private", "createdAt": "2022-10-11T02:34:18.000Z", "updatedAt": "2022-10-13T03:21:14.000Z", "permission": "editor", "isEditable": true, "resourceType": "map", "previewReadPath": "https://unfolded-data-production.storage.googleapis.com/userdata/012673bc-2bb1-4ccf-af78-7793b19b3144/maps/663e603f-e76a-4d1d-a3b5-f8dfc82d5cbc/preview.jpeg?X-Goog-Algorithm=GOOG4-RSA-SHA256&X-Goog-Credential=sharp-starlight-258101%40appspot.gserviceaccount.com%2F20221013%2Fauto%2Fstorage%2Fgoog4_request&X-Goog-Date=20221013T085326Z&X-Goog-Expires=1800&X-Goog-SignedHeaders=host&x-goog-signature=7513e5f9c37f00c291c91bdd5cc4b496d259eae81cac70985300f033dafb437e54b9b3ac5e090b759d1eb642c6728f2d0e21e57ea6b0d05bf554f5c5936372432ed75b051cbc1d4e3fc5a6590d6cbcd994332047352628f0ea4799c7227239832c6f5a2359f44260a1234a6c042c8dde5a7de5e14bcb9b99b9ac6374bb6955418714d837cf2e7b8913f4c4482c2ea043d77115459b2eb3062570796c9478819bd599b54bdbd2664910d5145aab1a0480489b616f3646224de0aeed41731dd23c7cc67c304cccd9b79ca5467a7d4c575f1976beb12b8a5bbb8af9b5919a83a8379e994515b2699458bb0d123683b5ea79eb049a3f2b4ec5ce7b1fc2eac112424a", "tags": [] }] };

  constructor() { }

  ngOnInit() {
  }

  ngAfterViewInit(): void {
  }

  toggleDetail() {
    this.sidenav.toggle();
  }

  onOpenMap(app: any) {

  }

  onImportMap() {
    document.getElementById("file_map")?.click();
  }

  onSelectFileMap(evt: any) {
    console.log(evt);
    const reader: FileReader = new FileReader();
    reader.onloadstart = (event) => {
      abp.ui.setBusy();
    }
    reader.onload = (event) => {
      var mapPackage = JSON.parse(reader.result + "");
      if (mapPackage.info) {
        var title = mapPackage.info.title ? mapPackage.info.title : 'Chưa đặt tên';
        var description = mapPackage.info.description + '';
        console.log(mapPackage);
        var rmMap = { title: title, description: description, mapPackage: JSON.stringify(mapPackage) }
        abp.services.app.resourcesV2.createMap(rmMap).then(function (rs: any) {
          console.log(rs);
          abp.ui.clearBusy();
        })
      }
    }
    reader.onloadend = (event) => {
      //abp.ui.clearBusy();
    }
    reader.readAsBinaryString(evt.target.files[0]);
  }
}
